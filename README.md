# PPT Diagram Chat Add-in

Production-oriented PowerPoint Office Add-in (Office.js) for Windows Desktop (primary), with cross-platform Office.js best-effort behavior.

## Features
- Task pane with **Chat / Settings / System** tabs.
- Natural-language interpretation to strict `DiagramSpec` via OpenAI SDK.
- Zod validation + one repair pass.
- Local fallback parser for simple patterns.
- Shapes-only rendering: rectangles + segmented elbow lines + edge labels.
- Update selected diagram via embedded META shape.
- Auto placement and deterministic tree layout.
- In-memory undo/redo action stack.

## Project structure
```
src/
  ui/
  core/
manifest.xml
```

## Prerequisites
- Node.js 18+
- PowerPoint desktop on Windows
- Office Add-in dev certificates trusted for HTTPS localhost (if required)

## Install
```bash
npm install
```

## Run in development
```bash
npm run dev
```
Serve task pane on `https://localhost:3000`.

## Build
```bash
npm run build
```

## Sideload on Windows PowerPoint
1. Start the web app: `npm run dev`.
2. Open PowerPoint → **Insert** → **My Add-ins** → **Manage My Add-ins**.
3. Upload/insert `manifest.xml` (or via Shared Folder Catalog).
4. Open **Home** tab and click **Open Diagram Chat**.

## Troubleshooting
- If add-in does not load, verify `https://localhost:3000/index.html` is reachable and cert trusted.
- If OpenAI call fails, set API key/model/base URL in **Settings**.
- If update fails, ensure selected object is `DIAGRAM::<id>::GROUP` generated by this add-in.
- If rendering overlaps existing content, add-in places center and warns in chat.
